# -*- coding: utf-8 -*-
"""PrepProcesor

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/156fBh3-ex6TRh5-g_URbyrPtExvXTpQO
"""

from sklearn.base import BaseEstimator, TransformerMixin
from sklearn.impute import SimpleImputer
import pandas as pd
import numpy as np

class PrepProcesor(BaseEstimator, TransformerMixin):
    def __init__(self):
        self.numeric_imputer = SimpleImputer(strategy='mean')
        self.categorical_imputer = SimpleImputer(strategy='most_frequent')

    def fit(self, X, y=None):
        # Fit imputers for numeric columns
        self.numeric_imputer.fit(X[['Area', 'Room']])
        # Fit imputers for categorical columns
        self.categorical_imputer.fit(X[['Address']])
        return self

    def transform(self, X, y=None):
        X = X.copy()

        # Handle missing values for numeric columns
        X['Area'] = self.numeric_imputer.transform(X[['Area']])
        X['Room'] = self.numeric_imputer.transform(X[['Room']])

        # Handle missing values for categorical columns
        X['Address'] = self.categorical_imputer.transform(X[['Address']])

        # Convert boolean columns to numeric (0/1)
        X['Parking'] = X['Parking'].astype(int)
        X['Warehouse'] = X['Warehouse'].astype(int)
        X['Elevator'] = X['Elevator'].astype(int)

        # Convert 'Area' to numeric in case it is stored as a string
        X['Area'] = pd.to_numeric(X['Area'], errors='coerce')

        # Drop target column if present
        if 'Price' in X.columns:
            X = X.drop(columns=['Price'])
        if 'Price(USD)' in X.columns:
            X = X.drop(columns=['Price(USD)'])

        return X

# Define the list of columns expected in the dataset
columns = ['Area', 'Room', 'Parking', 'Warehouse', 'Elevator', 'Address']